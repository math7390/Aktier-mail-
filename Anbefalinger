import os
import smtplib
from email.message import EmailMessage
import requests
from dotenv import load_dotenv

load_dotenv()

SMTP_SERVER = "smtp-relay.brevo.com"
SMTP_PORT = 587
SMTP_USERNAME = os.getenv("SMTP_USERNAME")
SMTP_PASSWORD = os.getenv("SMTP_PASSWORD")
FINNHUB_API_KEY = os.getenv("FINNHUB_API_KEY")

# Dine egne aktier (du kan tilfÃ¸je flere)
mine_aktier = ["AAPL", "TSLA", "NOVO-B.CO"]

def hent_anbefalinger(ticker):
    url = f"https://finnhub.io/api/v1/stock/recommendation?symbol={ticker}&token={FINNHUB_API_KEY}"
    response = requests.get(url)
    if response.status_code == 200:
        data = response.json()
        if data:
            anbefaling = data[0]
            return f"{ticker}: ğŸ“ˆ {anbefaling['strongBuy']} Strong Buy / ğŸŸ¢ {anbefaling['buy']} Buy / âšª {anbefaling['hold']} Hold / ğŸ”´ {anbefaling['sell']} Sell / ğŸ”» {anbefaling['strongSell']} Strong Sell"
    return f"{ticker}: Ingen data"

def lav_daglig_mail():
    besked = "ğŸ“Š Dagens analytikeranbefalinger:\n\n"
    for aktie in mine_aktier:
        besked += hent_anbefalinger(aktie) + "\n"
    return besked

def send_mail(indhold):
    msg = EmailMessage()
    msg["Subject"] = "ğŸ“¬ Dagens aktieanbefalinger"
    msg["From"] = SMTP_USERNAME
    msg["To"] = os.getenv("MODTAGER_EMAIL")
    msg.set_content(indhold)

    with smtplib.SMTP(SMTP_SERVER, SMTP_PORT) as smtp:
        smtp.starttls()
        smtp.login(SMTP_USERNAME, SMTP_PASSWORD)
        smtp.send_message(msg)

if __name__ == "__main__":
    mail_tekst = lav_daglig_mail()
    send_mail(mail_tekst)
requests
python-dotenv

# ğŸ“ˆ Aktieanbefaling Script â€“ Dansk Version

Et dagligt Python-script, som sender dig analytikeranbefalinger for dine valgte aktier via mail (Brevo SMTP).

## ğŸ§° Krav

- Python 3.10+
- Brevo SMTP-konto (gratis)
- Finnhub API-nÃ¸gle (gratis)
- Render.com (til at kÃ¸re scriptet dagligt)

## âš™ï¸ MiljÃ¸variabler (.env)

Kopier `.env.example` til `.env` og udfyld dine egne nÃ¸gler:
## ğŸš€ KÃ¸rsel

Installer afhÃ¦ngigheder:
KÃ¸r scriptet manuelt:
## â˜ï¸ KÃ¸r pÃ¥ Render.com

1. Opret repo og upload disse filer
2. GÃ¥ til [Render.com](https://render.com)
3. Opret en "Cron Job"
4. TilfÃ¸j miljÃ¸variabler fra din `.env` i "Environment Variables"
5. KÃ¸r dagligt med kommandoen `python main.py`

âœ… Du vil nu modtage daglige aktieanbefalinger pÃ¥ mail.
